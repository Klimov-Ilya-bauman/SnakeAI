# üêç Snake AI - DQN –æ–±—É—á–µ–Ω–∏–µ

–û–±—É—á–µ–Ω–∏–µ –∑–º–µ–π–∫–∏ –∏–≥—Ä–∞—Ç—å —Å –ø–æ–º–æ—â—å—é Deep Q-Network (Double DQN).

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –°–æ–∑–¥–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é)
python -m venv venv
source venv/bin/activate  # Mac/Linux

# –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install tensorflow-macos tensorflow-metal pygame numpy tensorboard

# –ò–õ–ò –ø—Ä–æ—Å—Ç–æ (–±–µ–∑ Metal GPU)
pip install tensorflow pygame numpy tensorboard
```

## –§–∞–π–ª—ã

- `config.py` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã (—Ä–∞–∑–º–µ—Ä –ø–æ–ª—è, —Ü–≤–µ—Ç–∞)
- `env.py` - —Å—Ä–µ–¥–∞ –¥–ª—è RL (–æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–æ–π)
- `agent.py` - DQN –∞–≥–µ–Ω—Ç (–Ω–µ–π—Ä–æ—Å–µ—Ç—å + –æ–±—É—á–µ–Ω–∏–µ)
- `train.py` - –æ–±—É—á–µ–Ω–∏–µ –±–µ–∑ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ (–±—ã—Å—Ç—Ä–æ)
- `train_visual.py` - –æ–±—É—á–µ–Ω–∏–µ –° –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π (–∫—Ä–∞—Å–∏–≤–æ)
- `play.py` - –∑–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –û–±—É—á–µ–Ω–∏–µ –ë–ï–ó –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ (–±—ã—Å—Ç—Ä–µ–µ)
```bash
python train.py
```

### 2. –û–±—É—á–µ–Ω–∏–µ –° –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π
```bash
python train_visual.py
```

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- `SPACE` - –ø–∞—É–∑–∞
- `F` - –±—ã—Å—Ç—Ä—ã–π —Ä–µ–∂–∏–º (–±–µ–∑ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏)
- `+/-` - —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
- `S` - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–¥–µ–ª—å
- `ESC` - –≤—ã—Ö–æ–¥

### 3. –°–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫ AI –∏–≥—Ä–∞–µ—Ç
```bash
python play.py                        # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥—ë—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å
python play.py models/best_50.keras   # –ò–ª–∏ —É–∫–∞–∂–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é
```

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- `+/-` - —Å–∫–æ—Ä–æ—Å—Ç—å –∏–≥—Ä—ã
- `R` - —Ä–µ—Å—Ç–∞—Ä—Ç —Ç–µ–∫—É—â–µ–π –∏–≥—Ä—ã
- `ESC` - –≤—ã—Ö–æ–¥

### 4. TensorBoard (–≥—Ä–∞—Ñ–∏–∫–∏)
```bash
tensorboard --logdir=logs
```
–û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:6006

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±—É—á–µ–Ω–∏—è

DQN –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- **12 –≤—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**: –æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ 4 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫ –µ–¥–µ, —Ç–µ–∫—É—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- **Double DQN**: –¥–≤–µ —Å–µ—Ç–∏ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- **Experience Replay**: –ø–∞–º—è—Ç—å –Ω–∞ 100k –æ–ø—ã—Ç–æ–≤
- **Epsilon-greedy**: –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏

## –ù–∞–≥—Ä–∞–¥—ã

- `+10` - —Å—ä–µ–ª –µ–¥—É
- `-10` - –≤—Ä–µ–∑–∞–ª—Å—è (—Å—Ç–µ–Ω–∞/—Ö–≤–æ—Å—Ç)  
- `+0.1` - –ø—Ä–∏–±–ª–∏–∑–∏–ª—Å—è –∫ –µ–¥–µ
- `-0.1` - –æ—Ç–¥–∞–ª–∏–ª—Å—è –æ—Ç –µ–¥—ã
- `-5` - –∑–∞—Ü–∏–∫–ª–∏–ª—Å—è (—Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ –±–µ–∑ –µ–¥—ã)
- `+100` - –ø–æ–±–µ–¥–∞ (–∑–∞–ø–æ–ª–Ω–∏–ª –≤—Å—ë –ø–æ–ª–µ)

## –¶–µ–ª—å

Win rate 70%+ –Ω–∞ –ø–æ–ª–µ 10x10 (–ø–æ–±–µ–¥–∞ = 100 –æ—á–∫–æ–≤ = –∑–º–µ–π–∫–∞ –Ω–∞ –≤—Å—ë –ø–æ–ª–µ).

–ù–∞ Mac M3 —Å 8GB RAM –æ–∂–∏–¥–∞–π:
- –ü–µ—Ä–≤—ã–µ —É—Å–ø–µ—Ö–∏: ~1000 —ç–ø–∏–∑–æ–¥–æ–≤
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è –∏–≥—Ä–∞: ~5000 —ç–ø–∏–∑–æ–¥–æ–≤
- –í—ã—Å–æ–∫–∏–π win rate: ~10000+ —ç–ø–∏–∑–æ–¥–æ–≤

## –°–æ–≤–µ—Ç—ã

1. **–ù–∞—á–Ω–∏ —Å train.py** - –±—ã—Å—Ç—Ä–µ–µ –æ–±—É—á–∞–µ—Ç—Å—è –±–µ–∑ pygame
2. **–°–º–æ—Ç—Ä–∏ TensorBoard** - —Ç–∞–º –≤–∏–¥–Ω–æ –ø—Ä–æ–≥—Ä–µ—Å—Å
3. **–°–æ—Ö—Ä–∞–Ω—è–π –º–æ–¥–µ–ª–∏** - –æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `models/`
4. **–ù–µ –∂–¥–∏ —á—É–¥–∞** - 70% –Ω–∞ 10x10 —ç—Ç–æ –°–õ–û–ñ–ù–û, –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –º–Ω–æ–≥–æ —ç–ø–∏–∑–æ–¥–æ–≤
